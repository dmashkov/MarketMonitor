# Changelog

Все значительные изменения в проекте MarketMonitor документируются в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

---

## [Unreleased]

### В разработке
- Frontend setup (React + TypeScript + Vite) - [IN PROGRESS]
- Supabase миграции - [IN PROGRESS]
- Модуль авторизации - [PLANNED]
- Admin функционал - [PLANNED]

---

## [0.1.0] - 2024-12-03

### Добавлено

#### Документация

- **docs/architecture.md** (2000+ строк)
  - Полная архитектура проекта MarketMonitor
  - Обзор проекта и цели (мониторинг климатического рынка России)
  - Технологический стек (React, Vite, Supabase, Claude API)
  - Система авторизации и ролей (admin, user)
  - Структура БД с 6 основными таблицами
  - Архитектура приложения с диаграммами потоков данных
  - Ключевые функциональные модули
  - 4-недельный план разработки MVP
  - Примеры SQL и TypeScript кода
  - Безопасность и мониторинг
  - Типы отслеживаемых событий (8 категорий)

- **docs/progress.md** (360+ строк)
  - Трекер прогресса разработки
  - История выполненных работ
  - Список следующих шагов по приоритетам
  - Прогресс бары для каждой фазы
  - Известные проблемы и решения
  - Важные архитектурные решения
  - История обновлений и версионирования

- **TODO.md** (500+ строк)
  - Детальный список всех задач
  - Разделение по приоритетам (критический, высокий, средний, обычный, низкий)
  - Разбор по неделям (Неделя 1-4)
  - Чек-листы для каждой задачи
  - Примеры SQL кода для миграций
  - Описание всех компонентов
  - Будущие улучшения

- **CHANGELOG.md** (этот файл)
  - История всех изменений проекта
  - Следование Keep a Changelog формату
  - Семантическое версионирование

#### Планирование

- Определен MVP scope для 4-недельной разработки
- Разбита разработка на 5 фаз:
  - Фаза 1: Foundation & Documentation (100% ✅)
  - Фаза 2: Backend Setup & Auth (0% ⏳)
  - Фаза 3: Admin Features (0% ⏳)
  - Фаза 4: User Features (0% ⏳)
  - Фаза 5: Automation & Polish (0% ⏳)

- Определены цели и milestones:
  - MVP: 4 недели
  - v1.0: после MVP (полная функциональность)
  - v1.1+: будущее (интеграции, мобильное, ML)

#### Бизнес-логика

- Определены 8 типов событий для мониторинга:
  1. Маркетинговые акции
  2. Изменение цен
  3. Изменения условий оплаты
  4. PR-активности
  5. Тендеры
  6. Соглашения о сотрудничестве
  7. Регулирование (сертификация, стандарты)
  8. Торговые площадки

- Определены 7 товарных сегментов:
  - Бытовые кондиционеры
  - Промышленная техника
  - Мультизональные системы
  - Вентиляционные системы
  - Тепловое оборудование
  - IoT
  - Сервисные услуги

- Определены 3 канала продаж:
  - B2B (бизнес для бизнеса)
  - B2G (бизнес для государства)
  - B2C (бизнес для потребителя)

- Целевая аудитория:
  - Руководители компаний
  - Коммерческие департаменты
  - Продуктовые менеджеры
  - Маркетологи

#### Система авторизации и ролей

- **Admin роль:**
  - Полный доступ ко всем функциям
  - Управление пользователями
  - Управление библиотекой промптов
  - Управление расписанием джобов
  - Ручной запуск поиска
  - Просмотр логов и статистики

- **User роль:**
  - Только чтение (read-only)
  - Просмотр событий с фильтрами
  - Просмотр дашбордов
  - Скачивание отчетов

#### Архитектура

- **Frontend:** React SPA на Netlify
- **Backend:** Supabase (serverless)
- **Database:** PostgreSQL (6 таблиц)
- **Authentication:** JWT через Supabase Auth
- **Security:** Row Level Security (RLS) на уровне БД
- **AI Layer:** Anthropic Claude API (claude-sonnet-4)
- **Search Tool:** Web Search tool для Claude
- **Хостинг:** Netlify (frontend), Supabase (backend)
- **CI/CD:** GitHub Actions

#### Структура БД (6 таблиц)

- **user_profiles**
  - Профили пользователей с ролями (admin/user)
  - Статус активности
  - Информация о создателе

- **events**
  - Найденные события на рынке
  - Информация: дата, компания, сегмент, тип, описание
  - Критичность (1-5)
  - Ссылка на источник
  - Сырые данные от AI (JSONB)

- **ai_prompts**
  - Библиотека промптов для поиска
  - Шаблон с переменными
  - Параметры по умолчанию (JSONB)
  - Статус активности

- **search_runs**
  - История всех запусков поиска
  - Статус (running, completed, failed)
  - Количество найденных событий
  - Время выполнения
  - Ошибки (если failed)

- **job_schedules**
  - Расписание автоматических запусков
  - Cron выражение
  - Параметры для подстановки
  - Время последнего и следующего запуска

- **audit_log** (опционально)
  - Логирование всех действий
  - User ID, action, resource
  - IP адрес и User Agent

#### Технические решения

- **TypeScript strict mode** - все типы явные, нет any
- **Vite + React** - быстрая разработка и сборка
- **Tailwind CSS** - утилити-first CSS
- **Ant Design** - готовые компоненты UI
- **TanStack Query** - управление состоянием и кешированием
- **Zustand** - простое глобальное состояние
- **Edge Functions** - серверная логика на Supabase
- **Row Level Security** - безопасность на уровне БД
- **Claude API** - качественные результаты поиска

#### API & Edge Functions (Планируются)

- **ai-search** - основная функция поиска информации
- **ai-summarize** - суммаризация событий периода
- **create-user** - создание новых пользователей (admin only)
- **execute-scheduled-job** - запуск расписанных джобов
- **export-report** - генерация отчетов

#### Компоненты (Планируются)

**Auth модуль:**
- LoginPage / RegisterPage
- useAuth hook
- ProtectedRoute компонент
- RequireRole компонент

**Admin компоненты:**
- UserManagement (CRUD пользователей)
- PromptLibrary (управление промптами)
- JobScheduler (управление расписаниями)
- SearchRunner (ручной запуск поиска)

**User компоненты:**
- EventsTable (таблица событий)
- EventFilters (фильтрация)
- Dashboard (графики и аналитика)
- ReportExport (экспорт отчетов)

#### GitHub & DevOps

- **.gitignore** - правильная безопасность (node_modules, .env, build)
- **GitHub Actions** - (планируется) scheduled search и CI/CD

### Изменено

*Ничего не изменено в этой версии (первая версия)*

### Удалено

*Ничего не удалено в этой версии (первая версия)*

### Исправлено

*Никаких исправлений в этой версии (первая версия)*

### Безопасность

- **.env** в .gitignore (никогда не коммитить секреты)
- **.env.example** в репозитории (шаблон для разработчиков)
- JWT токены через Supabase Auth (безопасное хранение)
- Row Level Security (RLS) на уровне БД (не доверяем frontend)
- Проверка прав в Edge Functions (backend enforcement)
- Валидация всех входных данных (SQL injection protection)

### Бизнес

- **MVP Сроки:** 4 недели
- **Запуск пилота:** начало января 2025
- **Целевой рынок:** Климатическое оборудование в России
- **Модель:** B2B SaaS для мониторинга рынка

### Финансовое

- **Anthropic API:** ~$5-20/день ($150-600/месяц)
- **Supabase:** Free tier достаточно для MVP
- **Netlify:** Free tier достаточно для MVP
- **Итого:** ~$150-600/месяц на AI поиск

### Метрики

- **Документации:** 2000+ строк архитектуры
- **TODO задач:** 100+ детальных задач
- **TypeScript типов:** 50+ интерфейсов (планируется)
- **Компонентов:** 20+ React компонентов (планируется)
- **Edge Functions:** 5 функций (планируется)
- **Строк кода:** ~3000-5000 (планируется к концу MVP)

---

## Стандарты и форматы

### Типы изменений

- `Added` - новая функциональность
- `Changed` - изменения в существующей функциональности
- `Deprecated` - функциональность, которая скоро будет удалена
- `Removed` - удаленная функциональность
- `Fixed` - исправление багов
- `Security` - изменения безопасности

### Версионирование

- **MAJOR.MINOR.PATCH** (Semantic Versioning)
- **0.x.x** - разработка, не production ready
- **1.0.0** - первый production release
- **1.1.0+** - новые фичи, продолжение поддержки

### Branches

- **main** - production code
- **develop** - development code
- **feature/*** - новые фичи
- **fix/*** - исправления багов
- **docs/*** - документация

---

## Внутренние ссылки

- [docs/architecture.md](docs/architecture.md) - полная архитектура
- [docs/progress.md](docs/progress.md) - отслеживание прогресса
- [TODO.md](TODO.md) - список задач
- [README.md](README.md) - информация о проекте
- [frontend/README.md](frontend/README.md) - frontend разработка

---

## Контакты

- GitHub Issues для ошибок и вопросов
- Документация в `/docs` для уточнений
- Архитектура в `docs/architecture.md` для деталей

---

**Ведется:** Claude Code
**Версия документа:** 0.1.0
**Последнее обновление:** 3 декабря 2024
