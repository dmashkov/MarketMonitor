# üìö –í—ã—É—á–µ–Ω–Ω—ã–µ –£—Ä–æ–∫–∏: –û—Ç–ª–∞–¥–∫–∞ Multi-Agent Pipeline

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2025-12-14
**–ù–∞ –æ—Å–Ω–æ–≤–µ:** –û—Ç–ª–∞–¥–∫–∞ –ø–æ–∏—Å–∫-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (Dec 14, 2025)
**–ü—Ä–∏–º–µ–Ω–∏–º–æ –∫:** Supabase Edge Functions, PostgreSQL RLS, Multi-Agent —Å–∏—Å—Ç–µ–º–∞–º

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏](#—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ-–æ—à–∏–±–∫–∏)
2. [–ü—Ä–∞–≤–∏–ª–∞ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏](#–ø—Ä–∞–≤–∏–ª–∞-–∏-–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏)
3. [–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –æ—Ç–ª–∞–¥–∫–∏](#–º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è-–æ—Ç–ª–∞–¥–∫–∏)
4. [–ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫](#–ø–æ—à–∞–≥–æ–≤—ã–π-–∞–ª–≥–æ—Ä–∏—Ç–º-–ø–æ–∏—Å–∫–∞-–æ—à–∏–±–æ–∫)
5. [–ß–µ–∫-–ª–∏—Å—Ç—ã](#—á–µ–∫-–ª–∏—Å—Ç—ã)

---

## üö® –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏

### 1. ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
```
search-orchestrator —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª –í –î–í–£–• –ú–ï–°–¢–ê–•:
  ‚ùå /supabase/functions/search-orchestrator/          (root level)
  ‚ùå /supabase/functions/agents/search-orchestrator/    (agents folder)

Supabase —Ä–∞–∑–≤–µ—Ä–Ω—É–ª –≤–µ—Ä—Å–∏—é –∏–∑ root level (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê–Ø)
–ú—ã —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–ª–∏ agents/ –≤–µ—Ä—Å–∏—é (–Ω–∏–∫–∞–∫ –Ω–µ –ø–æ–º–æ–≥–∞–ª–æ)
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –æ—à–∏–±–∫–∞:**
- –°–∏—Å—Ç–µ–º–∞ –Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —è–≤–Ω–æ —Å–æ–æ–±—â–∞–ª–∞, –∫–∞–∫–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è
- –î–≤–µ –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞ —Ä–∞—Å—Ö–æ–¥–∏–ª–∏—Å—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ agents/ –Ω–µ –æ—Ç—Ä–∞–∂–∞–ª–∏—Å—å –≤ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–º –∫–æ–¥–µ

**‚úÖ –ö–ê–ö –ù–ê–î–û –î–ï–õ–ê–¢–¨:**
```
1. –ò–º–µ—Ç—å –û–î–ù–û –º–µ—Å—Ç–æ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
   ‚îî‚îÄ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¢–û–õ–¨–ö–û –≤ /supabase/functions/agents/
   ‚îî‚îÄ –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è API –¢–û–õ–¨–ö–û –≤ /supabase/functions/api/

2. –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ CI/CD
   ‚îî‚îÄ –°–∫—Ä–∏–ø—Ç: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∫–∞–∂–¥–∞—è –ø–∞–ø–∫–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

3. –ü—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –ø—É—Ç—å
   ‚îî‚îÄ npx supabase functions deploy --function-dir supabase/functions/agents/

4. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤–µ—Ä—Å–∏—é
   ‚îî‚îÄ npx supabase functions list | grep <function-name>
   ‚îî‚îÄ –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ deployment_id –∏–∑–º–µ–Ω–∏–ª—Å—è
```

**Lesson:** –û–¥–∏–Ω –∫–æ–¥ - –æ–¥–Ω–æ –º–µ—Å—Ç–æ. –ï—Å–ª–∏ –¥–≤–µ –≤–µ—Ä—Å–∏–∏ - –æ–¥–Ω–∞ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç "–º–µ—Ä—Ç–≤–∞".

---

### 2. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏ –≤—ã–∑–æ–≤–∞ –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
```
search-orchestrator (root level) –≤—ã–∑—ã–≤–∞–ª:
  ‚ùå /functions/v1/agents/source-hunter     (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û)
  ‚ùå /functions/v1/agents/content-fetcher   (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û)

–ü—Ä–∞–≤–∏–ª—å–Ω–æ:
  ‚úÖ /functions/v1/source-hunter           (Supabase –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç /agents/)
  ‚úÖ /functions/v1/content-fetcher
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –æ—à–∏–±–∫–∞:**
- Supabase —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ –∏–º–µ–Ω–∏ –ø–∞–ø–∫–∏, –ù–ï –ø–æ –ø—É—Ç–∏ –∫ –Ω–µ–π
- –ù–µ–≤–∞–∂–Ω–æ –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è: `/agents/source-hunter` –∏–ª–∏ `source-hunter`
- URL –≤—Å–µ–≥–¥–∞ —Ç–æ–ª—å–∫–æ –ø–æ –∏–º–µ–Ω–∏: `/functions/v1/{FOLDER_NAME}`

**‚úÖ –ö–ê–ö –ù–ê–î–û –î–ï–õ–ê–¢–¨:**
```typescript
// –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏
const url = `${Deno.env.get('SUPABASE_URL')}/functions/v1/source-hunter`;

// –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –Ω–µ –¥–æ–±–∞–≤–ª—è–π –ø—É—Ç—å
‚ùå const url = `${supabaseUrl}/functions/v1/agents/source-hunter`;

// –ü—Ä–æ–≤–µ—Ä–∫–∞: –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ URL –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
console.log('üîç Calling:', {
  url: functionUrl,
  hasAuthHeader: !!authHeader,
  payload: body
});
```

**Lesson:** Supabase Edge Functions —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏, –∞ –Ω–µ –ø–æ –ø—É—Ç–∏.

---

### 3. ‚ùå RLS –ü–æ–ª–∏—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—É –∞–≥–µ–Ω—Ç–æ–≤

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
```
–¢–∞–±–ª–∏—Ü—ã –∏–º–µ–ª–∏ RLS –ø–æ–ª–∏—Ç–∏–∫–∏:
  ‚ùå event_types:        auth.role() = 'authenticated'
  ‚ùå segments:           auth.role() = 'authenticated'
  ‚ùå sources:            auth.role() = 'authenticated'
  ‚ùå search_runs:        requires authenticated users
  ‚ùå documents:          requires authenticated users

–†–µ–∑—É–ª—å—Ç–∞—Ç:
  - REST API (—Å anon key) –Ω–µ –≤–∏–¥–µ–ª –¥–∞–Ω–Ω—ã–µ ‚Üí –ø—É—Å—Ç–æ []
  - Edge Functions (—Å SERVICE_ROLE_KEY) –º–æ–≥–ª–∏ –ø–∏—Å–∞—Ç—å –Ω–æ –Ω–µ —á–∏—Ç–∞—Ç—å via REST
  - –ê–≥–µ–Ω—Ç—ã –Ω–µ –º–æ–≥–ª–∏ –Ω–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ ‚Üí "No sources found"
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –æ—à–∏–±–∫–∞:**
- RLS —Ç—Ä–µ–±—É–µ—Ç authentication –¥–ª—è SELECT
- –ê–≥–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç SERVICE_ROLE_KEY (–º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –≤–µ–∑–¥–µ)
- –ù–æ REST API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç anon key (–Ω–µ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å protected —Ç–∞–±–ª–∏—Ü—ã)
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É —Ç–µ–º —á—Ç–æ "–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å" –∏ "–Ω—É–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞"

**‚úÖ –ö–ê–ö –ù–ê–î–û –î–ï–õ–ê–¢–¨:**
```sql
-- –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: —Ç—Ä–µ–±—É–µ—Ç authentication
‚ùå CREATE POLICY "Users can view sources"
  ON sources FOR SELECT
  TO authenticated
  USING (is_user_active(auth.uid()));

-- –ü–†–ê–í–ò–õ–¨–ù–û: –¥–ª—è reference —Ç–∞–±–ª–∏—Ü –ø–æ–∑–≤–æ–ª–∏—Ç—å —á–∏—Ç–∞—Ç—å –≤—Å–µ–º
‚úÖ CREATE POLICY "Sources viewable by all"
  ON sources FOR SELECT
  USING (true);  -- –ß–∏—Ç–∞—Ç—å –º–æ–≥—É—Ç –≤—Å–µ

-- –î–ª—è write –æ–ø–µ—Ä–∞—Ü–∏–π - –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞
‚úÖ CREATE POLICY "Sources creatable"
  ON sources FOR INSERT
  WITH CHECK (true);  -- –ü–æ–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ–º (–≤ production - —á–µ—Ä–µ–∑ admin role)

-- –ü–ê–¢–¢–ï–†–ù –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç–∞–±–ª–∏—Ü:

-- Reference —Ç–∞–±–ª–∏—Ü—ã (—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏)
-- Read: –≤—Å–µ–º (true)
-- Write: admin —Ç–æ–ª—å–∫–æ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏)

-- User —Ç–∞–±–ª–∏—Ü—ã (–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
-- Read: owner –∏–ª–∏ admin
-- Write: owner –∏–ª–∏ admin

-- System —Ç–∞–±–ª–∏—Ü—ã (pipeline —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
-- Read: –≤—Å–µ–º –¥–ª—è monitoring
-- Write: —Ç–æ–ª—å–∫–æ –∞–≥–µ–Ω—Ç—ã
```

**–ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è fixing:**
```sql
-- Migration XXX_fix_rls_for_reference_tables.sql
DROP POLICY IF EXISTS "Old policy name" ON public.table_name;
CREATE POLICY "Table viewable by all"
  ON public.table_name FOR SELECT
  USING (true);
```

**Lesson:** Reference —Ç–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Ç–∞–µ–º—ã –≤—Å–µ–º–∏, –Ω–æ –ø–∏—Å–∞—Ç—å –≤ –Ω–∏—Ö —Ç–æ–ª—å–∫–æ admin.

---

### 4. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
```
–ö–æ–¥ –∏—Å–∫–∞–ª:          –†–µ–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:
  ‚ùå type            ‚úÖ source_type_id
  ‚ùå website         ‚úÖ website_url
  ‚ùå telegram        ‚úÖ telegram_channel

–†–µ–∑—É–ª—å—Ç–∞—Ç:
  - –û—à–∏–±–∫–∞ "column sources.type does not exist"
  - –ß–∞—Å—Ç–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å (null –∑–Ω–∞—á–µ–Ω–∏—è)
```

**‚úÖ –ö–ê–ö –ù–ê–î–û –î–ï–õ–ê–¢–¨:**
```typescript
// BEFORE –∫–∞–∂–¥–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:
// 1. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É –≤ Supabase Dashboard
// 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–æ—á–Ω—ã—Ö –∏–º–µ–Ω –∫–æ–ª–æ–Ω–æ–∫
// 3. –°–æ–∑–¥–∞—Ç—å —Ç–∏–ø—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã

// –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
interface SearchSource {
  id: string;
  name: string;
  source_type_id: string;  // UUID —Å—Å—ã–ª–∫–∞ –Ω–∞ source_types
  website_url: string | null;
  telegram_channel: string | null;
  priority: number;
}

// –ü—Ä–∏ select:
const { data } = await supabase
  .from('sources')
  .select('id, name, source_type_id, website_url, telegram_channel, priority')
  // ^^ –¢–û–ß–ù–´–ï –∏–º–µ–Ω–∞ –∏–∑ schema
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã:**
```bash
# 1. –í Supabase Dashboard ‚Üí SQL Editor
SELECT column_name, data_type FROM information_schema.columns
WHERE table_name = 'sources';

# 2. –ò–ª–∏ —Å–º–æ—Ç—Ä–∏ –≤ migrations/005_sources_and_segments.sql
# –¢–∞–º –æ–ø–∏—Å–∞–Ω–∏–µ CREATE TABLE - —ç—Ç–æ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
```

**Lesson:** –†–µ–≥—É–ª—è—Ä–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã —Å —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

---

### 5. ‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
```
–ö–æ–¥ –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç, –Ω–æ –Ω–æ–≤—ã–µ –ª–æ–≥–∏ –Ω–µ –≤–∏–¥–Ω—ã
–†–µ–∑—É–ª—å—Ç–∞—Ç:
  - –ö–∞–∑–∞–ª–æ—Å—å —á—Ç–æ —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –≤—Å–µ –µ—â–µ –∑–∞–ø—É—â–µ–Ω
  - –ü–æ—Ç—Ä–∞—á–µ–Ω–æ 30 –º–∏–Ω—É—Ç –Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
  - –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ: –Ω–æ–≤—ã–π –∫–æ–¥ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è, –ø—Ä–æ—Å—Ç–æ –±–µ–∑ –ª–æ–≥–æ–≤
```

**‚úÖ –ö–ê–ö –ù–ê–î–û –î–ï–õ–ê–¢–¨:**
```typescript
// –í–°–ï–ì–î–ê –¥–æ–±–∞–≤–ª—è–π —è–≤–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏ –≤–∞–∂–Ω—ã—Ö —à–∞–≥–∞—Ö

async function handleRequest(req: Request) {
  const startTime = Date.now();

  try {
    // –ú–∞—Ä–∫–µ—Ä: —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞
    console.log('üöÄ Search Orchestrator started');
    console.log('üìå SUPABASE_URL:', Deno.env.get('SUPABASE_URL'));
    console.log('üìå Version:', '8');  // –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–π –≤–µ—Ä—Å–∏—é

    const body = await req.json();
    console.log('üì• Request received:', {
      monitoring_profile_id: body.monitoring_profile_id
    });

    // –ú–∞—Ä–∫–µ—Ä: –∫–∞–∂–¥—ã–π –∑–Ω–∞—á–∏–º—ã–π —à–∞–≥
    console.log('üîç Loading monitoring profile...');
    const profile = await loadMonitoringProfile(body.monitoring_profile_id);
    console.log('‚úÖ Profile loaded:', profile.name);

    // –ú–∞—Ä–∫–µ—Ä: –≤—ã–∑–æ–≤Â≠ê —Ñ—É–Ω–∫—Ü–∏–π
    console.log('üîç Calling Source Hunter:', {
      url: functionUrl,
      hasAuthHeader: !!authHeader,
    });
    const result = await runSourceHunter(...);
    console.log('üì° Source Hunter response:', result.status);

    // –ú–∞—Ä–∫–µ—Ä: —É—Å–ø–µ—Ö
    console.log('‚úÖ Pipeline completed in', Date.now() - startTime, 'ms');

  } catch (error) {
    // –ú–∞—Ä–∫–µ—Ä: –æ—à–∏–±–∫–∞
    console.error('‚ùå Pipeline error:', error);
  }
}
```

**–≠–º–æ–¥–∑–∏ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏):**
```
üöÄ Start/Begin operation
üìå Configuration/Debug info
üì• Input received
üì§ Output/Response sent
üîç Calling external function
üì° Received response
‚úÖ Success milestone
‚ùå Error occurred
‚ö†Ô∏è Warning/Issue
üíæ Database operation
```

**–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—Å–µ–≥–¥–∞:**
```bash
# 1. –í—ã–∑–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏—é
curl -X POST https://...functions/v1/search-orchestrator \
  -H "..." \
  -d "{...}"

# 2. –°—Ä–∞–∑—É –∂–µ —Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ –≤ Supabase Dashboard
# Functions ‚Üí Logs ‚Üí —Ñ–∏–ª—å—Ç—Ä—É–π –ø–æ üöÄ
# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ –ª–æ–≥–∏ —Å —Ç–≤–æ–∏–º–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏

# –ï—Å–ª–∏ –ª–æ–≥–æ–≤ –Ω–µ—Ç - –∑–Ω–∞—á–∏—Ç —Å—Ç–∞—Ä—ã–π –∫–æ–¥ –≤—Å–µ –µ—â–µ –∑–∞–ø—É—â–µ–Ω
# –†–µ—à–µ–Ω–∏–µ: –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–∑–≤–µ—Ä–Ω—É–ª —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞
```

**Lesson:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏ - —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ —É–¥–æ–±—Å—Ç–≤–æ, —ç—Ç–æ —Å–ø–æ—Å–æ–± –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

---

### 6. ‚ùå –ù–µ —Ä–∞–∑–¥–µ–ª—è—Ç—å single mode –∏ batch mode

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:**
```
orchestrator –≤—ã–∑—ã–≤–∞–µ—Ç content-fetcher —Å document_ids: ["id1", "id2", ...]
content-fetcher –æ–∂–∏–¥–∞–µ—Ç: { document_id: "id1", url: "..." }

–†–µ–∑—É–ª—å—Ç–∞—Ç:
  ‚ùå "Missing required parameters: document_id, url"
```

**–î–∏–∑–∞–π–Ω –ø—Ä–æ–±–ª–µ–º–∞:**
- –û–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
- –ù–æ –∫–æ–¥ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–ø–æ—Å–æ–±
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

**‚úÖ –ö–ê–ö –ù–ê–î–û –î–ï–õ–ê–¢–¨:**
```typescript
// –ü–æ–¥–¥–µ—Ä–∂–∏ –û–ë–ê —Ä–µ–∂–∏–º–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

export interface ContentFetcherRequest {
  // Batch mode (–∏–∑ orchestrator)
  document_ids?: string[];
  search_run_id?: string;

  // Single mode (legacy/direct calls)
  document_id?: string;
  url?: string;
  document_type?: 'pdf' | 'html' | 'webpage';
}

// –í handler:
async function handler(req: Request) {
  const body = await req.json();

  if (body.document_ids && body.document_ids.length > 0) {
    // BATCH MODE: –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    return handleBatchMode(body.document_ids);
  } else if (body.document_id && body.url) {
    // SINGLE MODE: –æ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç
    return handleSingleMode(body.document_id, body.url);
  } else {
    // –û—à–∏–±–∫–∞
    return errorResponse('Missing parameters');
  }
}

async function handleBatchMode(documentIds: string[]) {
  // 1. –ü–æ–ª—É—á–∏ –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –ë–î –∑–∞ —Ä–∞–∑
  const { data: docs } = await supabase
    .from('documents')
    .select('id, file_url, source_url')
    .in('id', documentIds);

  // 2. –ü—Ä–æ—Ü–µ—Å—Å –≤—Å–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
  let updated = 0, failed = 0;
  for (const doc of docs) {
    try {
      const content = await fetchContent(doc.file_url || doc.source_url);
      await updateDocument(doc.id, content);
      updated++;
    } catch {
      failed++;
    }
  }

  return {
    status: 'success',
    documents_updated: updated,
    documents_failed: failed,
  };
}

async function handleSingleMode(docId: string, url: string) {
  const content = await fetchContent(url);
  await updateDocument(docId, content);
  return { status: 'success', document_id: docId };
}
```

**Lesson:** –§—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≥–∏–±–∫–∏–º–∏ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –Ω–æ —á–µ—Ç–∫–∏–º–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### –ü—Ä–∞–≤–∏–ª–æ 1: Single Source of Truth

**–ü—Ä–∏–Ω—Ü–∏–ø:**
```
–ö–∞–∂–¥—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç (—Ñ—É–Ω–∫—Ü–∏—è, —Ç–∞–±–ª–∏—Ü–∞, –∫–æ–Ω—Ñ–∏–≥) –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –†–û–í–ù–û –í –û–î–ù–û–ú –ú–ï–°–¢–ï
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
```
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
  - –§—É–Ω–∫—Ü–∏—è source-hunter: –¢–û–õ–¨–ö–û /functions/agents/source-hunter/
  - –¢–∏–ø—ã: –¢–û–õ–¨–ö–û –≤ types.ts —Ä—è–¥–æ–º —Å —Ñ—É–Ω–∫—Ü–∏–µ–π
  - –ú–∏–≥—Ä–∞—Ü–∏–∏: –¢–û–õ–¨–ö–û –≤ supabase/migrations/
  - –ö–æ–Ω—Ñ–∏–≥–∏: –¢–û–õ–¨–ö–û –≤ .env.local (–Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è)

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
  - –î–≤–∞ –º–µ—Å—Ç–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞
  - –¢–∏–ø—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö (–æ–¥–∏–Ω –±–æ–ª–µ–µ —Å–≤–µ–∂–∏–π)
  - –ö–æ–Ω—Ñ–∏–≥–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
  - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–± –æ–¥–Ω–æ–º –≤ —Ä–∞–∑–Ω—ã—Ö docs/
```

**Git –ü—Ä–∞–≤–∏–ª–æ:**
```bash
# –ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º –ø—Ä–æ–≤–µ—Ä—å —á—Ç–æ –Ω–µ—Ç –¥—É–±–ª–µ–π
find . -name "index.ts" -type f | sort
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ: agents/source-hunter/index.ts
# –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: source-hunter/index.ts –ò agents/source-hunter/index.ts
```

---

### –ü—Ä–∞–≤–∏–ª–æ 2: –Ø–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–∏–Ω—Ü–∏–ø:**
```
–°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∞–º–æ–æ—Å–≤–µ–¥–æ–º–ª—è—é—â–µ–π—Å—è –æ —Å–≤–æ–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
```typescript
// –í –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–≤–µ–¥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
console.log('='.repeat(80));
console.log('üì¶ Function Configuration');
console.log('  Name:', 'search-orchestrator');
console.log('  Version:', '8');  // –Ø–í–ù–û
console.log('  Environment:', Deno.env.get('DENO_ENV') || 'production');
console.log('  Supabase URL:', Deno.env.get('SUPABASE_URL'));
console.log('  Auth Type:', Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ? 'SERVICE_ROLE' : 'NONE');
console.log('='.repeat(80));
```

---

### –ü—Ä–∞–≤–∏–ª–æ 3: Fail Fast, Log Everything

**–ü—Ä–∏–Ω—Ü–∏–ø:**
```
–ü—Ä–æ–±–ª–µ–º–∞ –≤—ã—è–≤–ª—è–µ—Ç—Å—è –î–û —Ç–æ–≥–æ –∫–∞–∫ –∑–∞—Ç—Ä–æ–Ω–µ—Ç –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –º–æ–ª—á–∞–ª–∏–≤—ã–π –æ—Ç–∫–∞–∑
if (!requestData.document_id || !requestData.url) {
  return response(400, 'Missing params'); // –¢–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
if (!requestData.document_id || !requestData.url) {
  console.error('‚ùå Validation failed:', {
    received: requestData,
    expected: { document_id: 'string', url: 'string' },
    missingFields: [
      !requestData.document_id && 'document_id',
      !requestData.url && 'url',
    ].filter(Boolean)
  });

  return response(400, {
    status: 'error',
    error: 'Missing required parameters',
    expected: ['document_id', 'url'],
    received: Object.keys(requestData)
  });
}
```

---

### –ü—Ä–∞–≤–∏–ª–æ 4: –¢–µ—Å—Ç–∏—Ä—É–π –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ

**–ò–µ—Ä–∞—Ä—Ö–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```
1. UNIT: –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ
2. INTEGRATION: –î–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–º–µ—Å—Ç–µ
3. END-TO-END: –ü–æ–ª–Ω—ã–π pipeline
4. MONITORING: –í production –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π real –¥–∞–Ω–Ω—ã–µ
```

**–î–ª—è Edge Functions:**
```bash
# –£—Ä–æ–≤–µ–Ω—å 1: –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
curl -X POST https://.../functions/v1/source-hunter \
  -H "apikey: $ANON_KEY" \
  -d '{"prompt":"test"}'
# –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å –∏ –ª–æ–≥–∏

# –£—Ä–æ–≤–µ–Ω—å 2: –í—ã–∑–æ–≤ —á–µ—Ä–µ–∑ orchestrator
curl -X POST https://.../functions/v1/search-orchestrator \
  -H "apikey: $ANON_KEY" \
  -H "Authorization: Bearer $JWT" \
  -d '{"monitoring_profile_id":"..."}'
# –ü—Ä–æ–≤–µ—Ä—å –≤—Å–µ —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

# –£—Ä–æ–≤–µ–Ω—å 3: –ü—Ä–æ–≤–µ—Ä—å –ë–î
curl -H "apikey: $ANON_KEY" \
  'https://.../rest/v1/documents?order=created_at.desc&limit=1'
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏

# –£—Ä–æ–≤–µ–Ω—å 4: –î–∞—à–±–æ—Ä–¥ –≤ production
# –°–º–æ—Ç—Ä–∏ —Ä–µ–∞–ª—å–Ω—ã–µ search_runs –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã
```

---

## üîç –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –æ—Ç–ª–∞–¥–∫–∏

### –§–∞–∑–∞ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–ì–¥–µ –ø—Ä–æ–±–ª–µ–º–∞?)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
1. –û–ø–∏—Å–∞—Ç—å —Å–∏–º–ø—Ç–æ–º (—á—Ç–æ –≤–∏–¥–∏–º)
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å (–∫–∞–∫–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞—Ç—Ä–æ–Ω—É—Ç)
3. –°–æ–±—Ä–∞—Ç—å –ª–æ–≥–∏ (–≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö)
4. –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ (—Å–¥–µ–ª–∞—Ç—å —Ç–æ –∂–µ —Å–∞–º–æ–µ –∏ –ø–æ–π–º–∞—Ç—å –º–æ–º–µ–Ω—Ç)
5. –õ–æ–∫–∞–ª–∏–∑–æ–≤–∞—Ç—å (—Ç–æ—á–Ω–æ —á—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å)
```

**–ü—Ä–∏–º–µ—Ä:**
```
–°–ò–ú–ü–¢–û–ú: search-orchestrator –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "Source Hunter failed: 404"

–£–†–û–í–ï–ù–¨: search-orchestrator ‚Üí source-hunter –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–õ–û–ì–ò:
  "Requested function was not found"
  POST /functions/v1/agents/source-hunter

–í–û–°–ü–†–û–ò–ó–í–ï–î–ï–ù–ò–ï:
  curl https://.../functions/v1/agents/source-hunter
  ‚Üí 404 ‚ùå

  curl https://.../functions/v1/source-hunter
  ‚Üí 200 ‚úÖ

–õ–û–ö–ê–õ–ò–ó–ê–¶–ò–Ø:
  –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è URL –≤ search-orchestrator
  –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: /functions/v1/source-hunter
  –ï—Å—Ç—å: /functions/v1/agents/source-hunter
```

---

### –§–∞–∑–∞ 2: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≥–∏–ø–æ—Ç–µ–∑—ã

**–ú–∏–Ω–∏-—Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥–æ–π –≥–∏–ø–æ—Ç–µ–∑—ã:**

```bash
# –ì–∏–ø–æ—Ç–µ–∑–∞ 1: –§—É–Ω–∫—Ü–∏—è –Ω–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞
npx supabase functions list | grep source-hunter
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å —Ñ—É–Ω–∫—Ü–∏—é

# –ì–∏–ø–æ—Ç–µ–∑–∞ 2: –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –Ω–æ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è
curl https://.../functions/v1/source-hunter -d '{"test":true}'
# –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏: –µ—Å—Ç—å –ª–∏ –Ω–æ–≤—ã–µ –ª–æ–≥–∏ —Å —ç–º–æ–¥–∑–∏?

# –ì–∏–ø–æ—Ç–µ–∑–∞ 3: RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ
SELECT * FROM pg_policies WHERE tablename = 'sources';
# –°–º–æ—Ç—Ä–∏: –µ—Å—Ç—å –ª–∏ ALLOW ALL –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç authentication

# –ì–∏–ø–æ—Ç–µ–∑–∞ 4: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Ç–∞–±–ª–∏—Ü–µ
SELECT column_name FROM information_schema.columns
WHERE table_name = 'sources';
# –°–º–æ—Ç—Ä–∏: —Ç–æ—á–Ω—ã–µ –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫

# –ì–∏–ø–æ—Ç–µ–∑–∞ 5: –ü—Ä–æ–±–ª–µ–º–∞ –≤ authentication
curl https://.../functions/v1/search-orchestrator \
  -H "apikey: $ANON_KEY" \
  -H "Authorization: MISSING"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: "Missing authorization header" (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)

curl https://.../functions/v1/search-orchestrator \
  -H "apikey: $ANON_KEY" \
  -H "Authorization: Bearer INVALID_TOKEN"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –º–æ–∂–µ—Ç –±—ã—Ç—å 401 –∏–ª–∏ —É—Å–ø–µ—Ö (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–¥–∞)
```

---

### –§–∞–∑–∞ 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –Ω–∞–π–¥–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞:**
```
1. –û–ø—Ä–µ–¥–µ–ª–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π fix (–Ω–µ –ø–µ—Ä–µ–¥–µ–ª—ã–≤–∞–π –≤—Å–µ)
2. –°–æ–∑–¥–∞–π –º–∏–≥—Ä–∞—Ü–∏—é –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–∑–∞–ø–∏—Å–∞—Ç—å –≤ git)
3. –†–∞–∑–≤–µ—Ä—Ç–Ω–∏ –∏ —Å—Ä–∞–∑—É –ø—Ä–æ–≤–µ—Ä—å —á–µ—Ä–µ–∑ –ª–æ–≥
4. –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å –ë–î
5. –ü–æ—Ç–æ–º —Ç–µ—Å—Ç–∏—Ä—É–π –ø–æ–ª–Ω—ã–π pipeline
```

---

## üìã –ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫

### –ö–æ–≥–¥–∞ pipeline –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```mermaid
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –û–ø—Ä–µ–¥–µ–ª–∏ —Ç–æ—á–∫—É –æ—Ç–∫–∞–∑–∞                 ‚îÇ
‚îÇ    (–∫–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É?)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ —Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏     ‚îÇ
‚îÇ    Supabase Dashboard             ‚îÇ
‚îÇ    ‚Üí Functions ‚Üí Logs             ‚îÇ
‚îÇ    ‚Üí –§–∏–ª—å—Ç—Ä—É–π –ø–æ –∏–º–µ–Ω–∏ —Ñ—É–Ω–∫—Ü–∏–∏    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. –†–∞—Å–∫–æ–¥–∏—Ä—É–π –æ—à–∏–±–∫—É             ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:                 ‚îÇ
‚îÇ ‚Ä¢ 404 ‚Üí –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL         ‚îÇ
‚îÇ ‚Ä¢ 400 ‚Üí –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å       ‚îÇ
‚îÇ ‚Ä¢ 500 ‚Üí –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ             ‚îÇ
‚îÇ ‚Ä¢ –ü—É—Å—Ç–æ ‚Üí RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 4. –ü—Ä–æ–≤–µ—Ä—å –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å        ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ a) –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞?           ‚îÇ
‚îÇ    npx supabase functions list   ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ b) –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –≤—ã–∑–æ–≤–∞?       ‚îÇ
‚îÇ    /functions/v1/{NAME}           ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ c) –¢–∞–±–ª–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞?             ‚îÇ
‚îÇ    curl .../rest/v1/table        ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ d) RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç?       ‚îÇ
‚îÇ    SELECT * FROM pg_policies      ‚îÇ
‚îÇ                                  ‚îÇ
‚îÇ e) Schema —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–¥—É?    ‚îÇ
‚îÇ    –ü—Ä–æ–≤–µ—Ä—å column names           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 5. –í—ã–ø–æ–ª–Ω–∏ minimal fix            ‚îÇ
‚îÇ    –û–¥–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞ —Ä–∞–∑          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 6. –†–∞–∑–≤–µ—Ä—Ç–Ω–∏                      ‚îÇ
‚îÇ    npx supabase functions deploy  ‚îÇ
‚îÇ    npx supabase db push           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 7. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ —Å—Ä–∞–∑—É            ‚îÇ
‚îÇ    –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤—ã–µ –ª–æ–≥–∏   ‚îÇ
‚îÇ    —Å —Ç–≤–æ–∏–º–∏ —ç–º–æ–¥–∑–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 8. –ï—Å–ª–∏ –ø–æ–º–æ–≥–ª–æ - –∏–¥—å –∫ —à–∞–≥—É 5    ‚îÇ
‚îÇ    –ï—Å–ª–∏ –Ω–µ—Ç - –≤–µ—Ä–Ω–∏—Å—å –∫ —à–∞–≥—É 1    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è RLS –æ—à–∏–±–æ–∫

```bash
# –ï—Å–ª–∏ –≤–µ—Ä–Ω—É–ª–æ—Å—å –ø—É—Å—Ç–æ [] –≤–º–µ—Å—Ç–æ –¥–∞–Ω–Ω—ã—Ö

# –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å –µ—Å—Ç—å –ª–∏ –≤–æ–æ–±—â–µ –¥–∞–Ω–Ω—ã–µ
psql -U postgres -d postgres -c "SELECT COUNT(*) FROM sources;"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å > 0

# –®–∞–≥ 2: –ü–æ—Å–º–æ—Ç—Ä–∏ RLS –ø–æ–ª–∏—Ç–∏–∫—É
SELECT polname, poltype, poldefine FROM pg_policy
WHERE polrelid = 'sources'::regclass;

# –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: USING (true) –¥–ª—è SELECT
# –ï—Å–ª–∏: USING (auth.role() = 'authenticated') ‚Üí –Ω—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è

# –®–∞–≥ 3: –ü–æ–ø—Ä–æ–±—É–π —Å SERVICE_ROLE_KEY
curl -H "apikey: $SERVICE_ROLE_KEY" \
  'https://.../rest/v1/sources?limit=1'
# –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å (SERVICE_ROLE_KEY –æ–±—Ö–æ–¥–∏—Ç RLS)

# –®–∞–≥ 4: –ü–æ–ø—Ä–æ–±—É–π —Å ANON_KEY
curl -H "apikey: $ANON_KEY" \
  'https://.../rest/v1/sources?limit=1'
# –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç
# ‚Üí –ù—É–∂–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å POLICY
```

---

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è deployment –æ—à–∏–±–æ–∫

```bash
# –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –Ω–æ –º–µ–Ω—è—é—Ç—Å—è –Ω–µ –ø–æ–º–æ–≥–∞—é—Ç

# –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å –≤–µ—Ä—Å–∏—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
npx supabase functions list | grep <function-name>
# –°–º–æ—Ç—Ä–∏ VERSION –∏ UPDATED_AT

# –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É–ª
ls -la supabase/functions/<function-name>/
# –£–±–µ–¥–∏—Å—å —á—Ç–æ –∏–∑–º–µ–Ω—è–µ—à—å –≠–¢–û–¢ —Ñ–∞–π–ª

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
# –°—É—Ç—å: –µ—Å–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –≤–∏–¥–Ω–æ ‚Üí –∑–Ω–∞—á–∏—Ç —Å—Ç–∞—Ä—ã–π –∫–æ–¥

curl https://.../functions/v1/<function-name> -d '{"test":true}'

# –ü–æ—Ç–æ–º —Å—Ä–∞–∑—É —Å–º–æ—Ç—Ä–∏ –≤ Supabase Dashboard ‚Üí Logs
# –ï—Å–ª–∏ –≤–∏–¥–∏—à—å —Å–≤–æ–∏ –Ω–æ–≤—ã–µ –ª–æ–≥–∏ (—Å —ç–º–æ–¥–∑–∏) ‚Üí development OK
# –ï—Å–ª–∏ –≤–∏–¥–∏—à—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ ‚Üí –ø–µ—Ä–µ—Ä–∞–∑–≤–µ—Ä—Ç–Ω–∏ –∏–ª–∏ –µ—Å—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

# –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –Ω–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏
find supabase/functions -name "index.ts" | \
  xargs grep -l "source-hunter"
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –û–î–ù–û —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
# –ï—Å–ª–∏ –¥–≤–∞ ‚Üí delete –æ–¥–∏–Ω –∏ –ø–µ—Ä–µ—Ä–∞–∑–≤–µ—Ä—Ç–Ω–∏
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç—ã

### –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π Edge Function

```
‚ñ° –§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ: supabase/functions/agents/{name}/
‚ñ° –ï—Å—Ç—å index.ts, types.ts, deno.json
‚ñ° –¢–∏–ø—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã (no any)
‚ñ° –ï—Å—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —ç–º–æ–¥–∑–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏
‚ñ° –¢–µ—Å—Ç—ã –≤—ã–≤–æ–¥–∞ (–∫–∞–∫–∏–µ –ø–æ–ª—è –≤–µ—Ä–Ω–µ—Ç)
‚ñ° Error handling –¥–ª—è –≤—Å–µ—Ö —Å–ª—É—á–∞–µ–≤
‚ñ° CORS headers –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
‚ñ° –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
```

### –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º

```
‚ñ° –ù–∏–∫–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º –Ω–µ—Ç –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ
  (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å: find . -name "index.ts" | grep function-name)
‚ñ° –ö–æ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ –Ω—É–∂–Ω–æ–π –ø–∞–ø–∫–∏
  (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å: npx supabase functions deploy --list)
‚ñ° –õ–æ–≥–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã (–≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã)
‚ñ° –í–µ—Ä—Å–∏—è —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–∞ –≤ –∫–æ–¥–µ –∏–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
‚ñ° –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ –≥–æ—Ç–æ–≤ (curl –∫–æ–º–∞–Ω–¥–∞)
‚ñ° –û—á–∏—â–µ–Ω—ã –∫–æ–Ω—Å–æ–ª–∏ (—É–¥–∞–ª–µ–Ω—ã debug logs —á—Ç–æ –Ω–µ –Ω—É–∂–Ω—ã)
‚ñ° –ö–æ–º–º–∏—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

### –ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```
‚ñ° –§—É–Ω–∫—Ü–∏—è –ø–æ—è–≤–∏–ª–∞—Å—å –≤ npx supabase functions list
‚ñ° VERSION —É–≤–µ–ª–∏—á–∏–ª—Å—è
‚ñ° –¢–µ—Å—Ç–æ–≤—ã–π –≤—ã–∑–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω
‚ñ° –õ–æ–≥–∏ –≤–∏–¥–Ω—ã –≤ Dashboard —Å –Ω–æ–≤—ã–º–∏ —ç–º–æ–¥–∑–∏
‚ñ° –ù–µ—Ç –æ—à–∏–±–æ–∫ "not found" –∏–ª–∏ "permission denied"
‚ñ° –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –ø–∏—à–µ—Ç –≤ –ë–î - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—è–≤–∏–ª–∏—Å—å –¥–∞–Ω–Ω—ã–µ
‚ñ° –ü–æ–ª–Ω—ã–π pipeline –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω (–µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
‚ñ° –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ production —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º
```

### –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ production

```
‚ñ° –í—Å–µ tests –ø—Ä–æ—à–ª–∏ ‚úÖ
‚ñ° –ö–æ–¥ reviewed (—Ö–æ—Ç—è –±—ã –≤–∏–∑—É–∞–ª—å–Ω–æ)
‚ñ° –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
‚ñ° RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
‚ñ° –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
‚ñ° –û—Ç–∫–∞—Ç –ø–ª–∞–Ω –≥–æ—Ç–æ–≤ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–µ—Ç—Å—è)
‚ñ° –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
‚ñ° –ö–æ–º–º–∏—Ç –≤ main branch ready to merge
```

---

## üéì –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –¢—Ä–∏ –∑–æ–ª–æ—Ç—ã—Ö –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç–ª–∞–¥–∫–∏ multi-agent —Å–∏—Å—Ç–µ–º

1. **–ò–∑–æ–ª—è—Ü–∏—è**
   - –¢–µ—Å—Ç–∏—Ä—É–π –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
   - –ü—Ä–µ–∂–¥–µ —á–µ–º –≤–∏–Ω–∏—Ç—å –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é, —É–±–µ–¥–∏—Å—å —á—Ç–æ —Ç–≤–æ—è —Ä–∞–±–æ—Ç–∞–µ—Ç

2. **–ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å**
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —è–≤–Ω—ã–º–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏
   - –ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø–µ—Ä–≤–æ–µ —á—Ç–æ –¥–µ–ª–∞—é - –ø—Ä–æ–≤–µ—Ä—è—é –ª–æ–≥–∏

3. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**
   - –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç
   - –ù–µ –Ω–∞–¥–µ—é—Å—å —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ü—Ä–æ–≤–µ—Ä—è—é —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ

### –ö–æ–≥–¥–∞ —Ç—ã –∑–∞—Å—Ç—Ä—è–ª

**–ü—Ä–æ—Ç–æ–∫–æ–ª:**
```
1. –°–¥–µ–ª–∞–π –ø–µ—Ä–µ—Ä—ã–≤ (—Å–≤–µ–∂–∏–π –≤–∑–≥–ª—è–¥)
2. –¢–∏—Ö–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–∏ –æ—à–∏–±–∫—É (step-by-step)
3. –ó–∞–ø–∏—à–∏ –í–°–ï –ª–æ–≥–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å —á—Ç–æ-—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏–ª)
4. –ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —Å–∞–º—ã–π —Å—Ç—Ä–∞–Ω–Ω—ã–π –º–µ—Å—è—Ü –≤ –ª–æ–≥–∞—Ö
5. –ü—Ä–æ–≤–µ—Ä—å —Å–∞–º—ã–µ –æ—á–µ–≤–∏–¥–Ω—ã–µ –æ—à–∏–±–∫–∏ (–æ–Ω–∏ —á–∞—Å—Ç–æ —Å–∫—Ä—ã—Ç—ã –≤ plain sight)
6. –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ –ø–æ–Ω—è–ª - –æ–±—ä—è—Å–Ω–∏ –∫–æ–º—É-—Ç–æ –¥—Ä—É–≥–æ–º—É
   (–ø—Ä–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–∏ —Å–∞–º –Ω–∞–π–¥–µ—à—å –æ—à–∏–±–∫—É –≤ 80% —Å–ª—É—á–∞–µ–≤)
```

---

## üìö –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

- `docs/DEVELOPMENT_STATUS.md` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- `supabase/migrations/` - –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ë–î
- `supabase/functions/agents/*/index.ts` - –∫–æ–¥ –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
- `.claude/settings.local.json` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Claude Code

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0.0
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-12-14
